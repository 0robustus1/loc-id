\documentclass[a4paper,11pt,DIV=25]{scrartcl}

\usepackage[utf8x]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{longtable}
%\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{hyperref}
\author{Tim Reddehase}
\date{2014-09-13}

\newenvironment{oitemize}{%
  \renewcommand{\labelitemii}{$\bullet$}%
  \vspace{-15pt}
  \begin{itemize}}
  {\end{itemize}}

\begin{document}

\Huge
\begin{center}
  Ontohub loc/id\\
  \bigskip
  \includegraphics[width=0.3\textwidth]{ontohub-loc_id-logo.pdf}
\end{center}
\normalsize

\bigskip

\section{Idea}

Generally an Ontohub loc/id (locator/identifier) is just an IRI of an ontology
or one of its members (symbols, sentences, mappings, child-ontologies). However
Ontohub loc/ids are generated by the Ontohub application and assigned to an
ontology.  We try to infer them from the path of the repository, the path of
the ontology and the specific name. Additionally we ensure that this specific
IRI is actually a locator and not \textit{just} an identifier.

\section{Status Report}

Currently ontologies have a somewhat MMT-like approach with a $?$ being used as
a separator between parent and child-ontology:

\begin{itemize}
  \item \url{http://ontohub.org/dol-testing/double_mapped_blendoid?DMB-CommonSource}
\end{itemize}

Currently this whole string of text is stored as a database field in the
ontologies-table.  This specifically includes the IRI-Schema, the domain name
and the implicit port. Unimpacted by the decision which style to choose we
should make some adjustments to the storing system. See the Database section
for that.

\pagebreak

\section{MMT-Style - Ontohub Edition}

Employing MMT in Ontohub would result in using $?$ as a separator (see the
Status Report).  However employing $?$ denotes the HTTP-Query-String. So
specifying an ontology(-element) would use both the hierarchical part and part
of the query-string for IRIs.

\subsection{Examples}

\begin{tabularx}{\textwidth}{p{.1\textwidth}p{.2\textwidth}p{.7\textwidth}}
  \textit{Distributed Ontology} & & \\
  \hline
  & Distributed Ontology & \url{http://ontohub.org/dol-testing/double_mapped_blendoid}\\
  & Child Ontology & \url{http://ontohub.org/dol-testing/double_mapped_blendoid?DMB-CommonSource}\\
  & Mapping & \url{http://ontohub.org/dol-testing/double_mapped_blendoid?SomeMapping}\\
  & Symbol & \url{http://ontohub.org/dol-testing/double_mapped_blendoid?DMB-CommonSource?KitchenTable}\\
  & Sentence & \url{http://ontohub.org/dol-testing/double_mapped_blendoid?DMB-CommonSource?Ax02}\\
  & & \\
  \textit{Ontology} & & \\
  \hline
  & Distributed Ontology & \url{http://ontohub.org/dol-testing/double_mapped_blendoid}\\
  & Ontology & \url{http://ontohub.org/default/pizza}\\
  & Mapping & \url{http://ontohub.org/default/pizza?SomeMapping}\\
  & Symbol & \url{http://ontohub.org/default/pizza??KitchenTable}\\
  & Sentence & \url{http://ontohub.org/default/pizza??Ax02}\\
\end{tabularx}

\subsection{Conflicts in Names}

Technically the loc/id of a symbol and a sentence could conflict. Additionally
names of single ontologies in distributed ontologies (child-ontology) could
conflict with mappings.

\subsection{Benefits and Disadvantages}

The major benefit is of course that this system would be compatible with all
software products which comply with the MMT-Standard.  Sadly this breaks with
some conventions across the web. For example data-retrieval in different
formats would solely rely on the MIME-Type of the HTTP requests (Accept
Header).

So the convention for Web-Application (and/or their APIs) to allow adding the
file-extension to a request in order to allow making file-based decision
without forcing specific Accept-Headers.

Technically we could still add this file-extension in the query-string, but
this would require special handling and still breaks the convention.

\pagebreak

\section{Proposed Ontohub-Style}

Identifying Ontologies and their members in Ontohub is a hierarchical task. An
ontology belongs to a repository and a child-ontology belongs to a parent
ontology. Mappings, symbols and sentences in turn belong to a ontology. So we
should/could perfectly use the hierarchical portion of an IRI instead of the
query string. This would mean using a forward slash (\textit{/}) as separator.

\subsection{Examples}

\begin{tabularx}{\textwidth}{p{.1\textwidth}p{.2\textwidth}p{.7\textwidth}}
  \textit{Distributed Ontology} & & \\
  \hline
  & Distributed Ontology & \url{http://ontohub.org/dol-testing/double_mapped_blendoid}\\
  & Child Ontology & \url{http://ontohub.org/dol-testing/double_mapped_blendoid/DMB-CommonSource}\\
  & Mapping & \url{http://ontohub.org/dol-testing/double_mapped_blendoid/SomeMapping}\\
  & Symbol & \url{http://ontohub.org/dol-testing/double_mapped_blendoid/DMB-CommonSource/KitchenTable}\\
  & Sentence & \url{http://ontohub.org/dol-testing/double_mapped_blendoid/DMB-CommonSource/Ax02}\\
  & & \\
  \textit{Ontology} & & \\
  \hline
  & Distributed Ontology & \url{http://ontohub.org/dol-testing/double_mapped_blendoid}\\
  & Ontology & \url{http://ontohub.org/default/pizza}\\
  & Mapping & \url{http://ontohub.org/default/pizza/SomeMapping}\\
  & Symbol & \url{http://ontohub.org/default/pizza/Veneziana}\\
  & Sentence & \url{http://ontohub.org/default/pizza/Ax02}\\
\end{tabularx}

\subsection{Conflicts in Names}

Again the loc/id of a symbol and sentence can conflict. Additionally the
mappings can conflict with symbols and sentences as well. It would be possible
to alleviate this by prepending a hierarchical portion to determine the type of
member. This could look like this:

\begin{itemize}
  \item Mapping: \url{http://ontohub.org/default/pizza/map/SomeMapping}
  \item Symbol: \url{http://ontohub.org/default/pizza/sym/Veneziana}
  \item Sentence: \url{http://ontohub.org/default/sen/Ax02}
\end{itemize}

\subsection{Benefits and Disadvantages}

This solution should be completely compliant with common HTTP/Rest conventions.
So file-extensions for requiring a specific response-body-type should be
entirely possible.

Additionally it would be possible to nest other routes/controllers
\textit{under} the loc/id (e.g. list of mappings for an ontology, list of
symbols/sentences, graphs and the like) - I would propose namespacing for this.

However the main disadvantage would be incompatibility with MMT.

\pagebreak

\section{General Notes}

We could also allow multiple IRIs similar to the loc/id style. For version and
commits we would necessarily need to this. So we could support MMT as another
extension.

Here are some examples:

\begin{itemize}
  \item Version: \url{http://ontohub.org/default/ref/2/pizza/map/SomeMapping}
  \item Commit: \url{http://ontohub.org/default/ref/def3ab/pizza/map/SomeMapping}
  \item Branch: \url{http://ontohub.org/default/ref/master/pizza/map/SomeMapping}
  \item Date: \url{http://ontohub.org/default/ref/2014-09-07/pizza/map/SomeMapping}
  \item MMT: \url{http://ontohub.org/default/ref/mmt/pizza??SomeMapping}
  \item File: \url{http://ontohub.org/default/tree/some_directory/some_child_dir/Foo.txt}
\end{itemize}

\section{Database}

Currently the IRI is completely stored in the database. With the move to the
specific system (loc/id) we shall change this.

Ontohub loc/ids are specific to an instance of the Ontohub-Application. However
such an application might be reachable via multiple multiple FQDNs (full
qualified domain name) and ports. So instead we should expect a loc/id be a
tuple consisting of the specific application instance, represented by the set
of their schema-fqdn-port tuples, and the actual identifying portion
beginning with the hierarchical forward slash (\textit{/}).

This would also ease the work in development, as currently ontology-IRIs are
generated to \url{http://localhost:3000}, which is a problem when we try to
access them via a server running on port \textit{9001} or a domain name of
\url{ontohub.dev}.

\end{document}
