\documentclass[a4paper,11pt,DIV=25]{scrartcl}

\usepackage[utf8x]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{longtable}
%\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{hyperref}
\author{Tim Reddehase}
\date{2014-10-13}

\newenvironment{oitemize}{%
  \renewcommand{\labelitemii}{$\bullet$}%
  \vspace{-15pt}
  \begin{itemize}}
  {\end{itemize}}

\begin{document}

\Huge
\begin{center}
  Ontohub loc/id\\
  \bigskip
  \includegraphics[width=0.3\textwidth]{ontohub-loc_id-logo.pdf}
\end{center}
\normalsize

\bigskip

\section{Idea}

Generally an Ontohub loc/id (locator/identifier) is just an IRI of an ontology
or one of its members (symbols, sentences, mappings, child-ontologies). However
Ontohub loc/ids are generated by the Ontohub application and assigned to an
ontology.  We try to infer them from the path of the repository, the path of
the ontology and the specific name. Additionally we ensure that this specific
IRI is actually a locator and not \textit{just} an identifier.

\section{Ontohub-Style}

Identifying Ontologies and their members in Ontohub is a hierarchical task. An
ontology belongs to a repository and a child-ontology belongs to a parent
ontology. Mappings, symbols and sentences in turn belong to a ontology. So we
should/could perfectly use the hierarchical portion of an IRI instead of the
query string. This would mean using a forward slash (\textit{/}) as separator.

Ontohub loc/ids are specific to an instance of the Ontohub-Application. However
such an instance might be reachable via multiple multiple FQDNs (fully
qualified domain name) and ports. So instead we should expect a
\textit{qualified loc/id} to be a tuple consisting of the specific application
instance, represented by the set of their schema-fqdn-port tuples, and the
actual identifying portion beginning with the hierarchical forward slash
(\textit{/}).

\subsection{qualified loc/id structure}

\begin{enumerate}
  \item Set of Schema + FQDNs + Port for an instance: \textbf{INSTANCE}, e.g.\\
    \{ \url{http://localhost:3000}, \url{http://localhost:9001}, \url{http://ontohub.dev} \}
  \item Identifying portion loc/id with leading forward slash (\textit{/})
  \begin{itemize}
    \item The identifying portion is split into two parts.
    \item \textbf{HIERARCHY}: is the \url{path/to/ontology-file}, with elements split
      by a forward slash (\textit{/}).
    \item \textbf{MEMBER:} is the element of the ontology at the specific
      position. It is being separated from the \textbf{HIERARCHY} by two
      forward slashes (\textit{//}). These forward slashes are also being used
      to separate members inside of \textbf{MEMBER} (e.g. in the case of a
      child-ontology which contains a symbol).
  \end{itemize}
\end{enumerate}

\subsection{Examples}

\begin{tabularx}{\textwidth}{p{.1\textwidth}p{.2\textwidth}p{.7\textwidth}}
  \textit{Distributed Ontology} & & \\
  \hline
  & Distributed Ontology & \url{/dol-testing/double_mapped_blendoid}\\
  & Child Ontology & \url{/dol-testing/double_mapped_blendoid//DMB-CommonSource}\\
  & Mapping & \url{/dol-testing/double_mapped_blendoid//SomeMapping}\\
  & Symbol & \url{/dol-testing/double_mapped_blendoid//DMB-CommonSource//KitchenTable}\\
  & Sentence & \url{/dol-testing/double_mapped_blendoid//DMB-CommonSource//Ax02}\\
  & & \\
  \textit{Ontology} & & \\
  \hline
  & Distributed Ontology & \url{/dol-testing/double_mapped_blendoid}\\
  & Ontology & \url{/default/pizza}\\
  & Mapping & \url{/default/pizza//SomeMapping}\\
  & Symbol & \url{/default/pizza//Veneziana}\\
  & Sentence & \url{/default/pizza//Ax02}\\
\end{tabularx}

Fully qualified symbols (e.g. /sym/$+:NatxNat->Nat$) will need to be escaped
but will be supported.

\section{Other loc/id based IRIs}

\begin{itemize}
  \item Version: \url{/ref/2/default/pizza/map//SomeMapping}
  \item Commit: \url{/ref/def3ab/default/pizza/map//SomeMapping}
  \item Branch: \url{/ref/master/default/pizza/map//SomeMapping}
  \item Date: \url{/ref/2014-09-07/default/pizza/map//SomeMapping}
    \begin{itemize}
      \item would take the latest commit which applies to the Date range.
    \end{itemize}
  \item MMT: \url{/ref/mmt/default/pizza??SomeMapping}
    \begin{itemize}
      \item allows the use of fully compliant MMT-style
    \end{itemize}
  \item File: \url{/tree/default/some_directory/some_child_dir/Foo.txt}
    \begin{itemize}
      \item applies to HEAD commit of main branch (currently always \textit{master})
    \end{itemize}
  \item File at reference: \url{/treeref/{REF}/default/tree/some_directory/some_child_dir/Foo.txt}
    \begin{itemize}
      \item where \{REF\} is any of the above possible ref-types: Version, Commit, Branch or Date
    \end{itemize}
\end{itemize}

\section{Disambiguating}

If the \url{path/to/an-ontology} can actually also be a path to a directory  --
which would be possible if there were a directory named \textbf{pizza} and an
ontology named \textbf{pizza.owl} -- will the loc/id be resolved to a
disambiguating page. On this page will be a link to the tree for the directory
and a link to a \url{/ref/master/} qualified version of the ontology.

If however the loc/id is requested with a \textit{text/plain} content type we
will always serve the ontology.

\end{document}
